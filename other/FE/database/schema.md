# スキーマ

スキーマ(Schema)とは、データの構造や定義、関係性や制約などを形式的に記述したもの。

データベースがどんなテーブルで構成されていて、どんなデータが入るかを定義する設計図のようなもの。

データそのものではなく、データがどのように構成され、相互にどのように関連付けられているかを示すメタデータ。

- メタデータ: データに関するデータ

スキーマには主に以下の情報が含まれる。

- テーブルの定義: テーブル名、含まれる列の名前とデータ型
- 制約: 主キー、外部キー、NULL値の許可不許可などのルール
- インデックス: データの検索を高速化するための索引情報
- ビュー: 仮想的なテーブル定義

## 3層スキーマ

利用者の視点や目的によって、データベースの構造を3つの階層に分けて考えるモデル。

| スキーマ     | 説明                                                                   | 関係者                   |
|--------------| -----------------------------------------------------------------------|--------------------------|
| 外部スキーマ | ユーザやアプリケーションごとの「見え方」。データの一部や別名などもOK。 | 利用者(エンドユーザ)     |
| 概念スキーマ | データベース全体の論理的な構造。テーブル、属性、型、制約などの定義。   | DB設計者(論理設計担当)   |
| 内部スキーマ | 実際の記憶媒体でのデータの物理構造。保存形式、インデックスなど。       | DBエンジニア(物理設計者) |

### 1 外部スキーマ(External Schema)

別名、サブスキーマ

個々のエンドユーザーやアプリケーションの視点。

ユーザーが見たいデータや、アプリケーションが必要とするデータだけを定義する。

他のユーザーが利用するデータは隠蔽される。=> ビューとして実現されることが多い

### 2 概念スキーマ(Conceptual Schema)

組織全体の視点。

データベースに格納するすべてのデータの論理的な構造や、データ間の関係、制約を定義する。

データベース管理者(DBA)が設計する、最も重要な全体構造の定義。

### 3 内部スキーマ(Internal Schema)

物理的な記憶装置の視点。

概念スキーマで定義されたデータを、実際にどのように物理的に格納するか(ファイル構造・インデックス配置・記憶領域など)を定義。

利用者はこの層を意識する必要はない。

### データの独立性

この3層スキーマ構造があることで、データ独立性が保たれる。

- 論理的データ独立性: 概念スキーマを変更しても、外部スキーマに影響を与えないようにする
- 物理的データ独立性: 内部スキーマを変更しても、概念スキーマに影響を与えないようにする

これにより、データベースの変更やメンテナンスを柔軟に行うことができる。

