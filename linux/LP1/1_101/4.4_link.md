# ハードリンクとシンボリックリンク

ファイルやディレクトリに別名を付け、異なった名前で同一のファイルにアクセスできる仕組み

## 1 ハードリンク

Linuxではファイルをディスクに保存すると重複しないiノード番号が割り当てられる

すべてのファイルには対応するiノードが存在し、

iノードにはディスク上のファイルに関する属性情報が格納されている

ディレクトリは特殊なファイルの形態で、所属するファイル名とiノードを関連づけている

iノードに格納されている情報(一部)
- ファイル種別
- ファイルサイズ
- アクセス権
- 所有者
- リンク
- ディスク上の物理的な保存場所(ブロック番号)

ファイルの実態が1つでも、その実態を参照するファイルが複数あれば、

それぞれのファイル名で同一の実態を参照することができる => これが`ハードリンク`

ハードリンクは元ファイルとリンクとして作成したファイルが同じ(同一のiノード番号)

いずれかのハードリンクに変更があれば元ファイル、他ハードリンクも変更される

複数のハードリンクがある場合は、すべて削除するまではファイルの実態は残る

`ls -li` でiノード番号とリンクの数が確認できる

iノードはファイルシステムごとに管理されているので、異なるファイルシステムでハードリンクは作成負荷

=> ディレクトリのハードリンクを作成することもできない

## 2 シンボリックリンク

リンク元の場所を指し示す

=> シンボリックリンク自身が持っているのは、リンク元へのポインタ

シンボリックリンクを残したまま、元ファイルを削除すると実態ファイルが見つからずエラー

シンボリックリンクは異なるファイルへのリンク作成可能、ディレクトリのリンクも作成可能

```
-rw-r--r--  3 john  staff  40  8 17 15:21 sample.org
-rw-r--r--  3 john  staff  40  8 17 15:21 sample1
-rw-r--r--  3 john  staff  40  8 17 15:21 sample2
lrwxr-xr-x  1 john  staff  10  8 17 15:27 sample3_sym -> sample.org
```
sample1,2がハードリンク、sample3がシンボリックリンク(実際のアクセス権は元ファイル)

## 3 リンクの作成(`ln`)

オプションなしで`ハードリンク`, `-s`オプションで`シンボリックリンク`

## 4 リンクのコピー

cpでシンボリックリンクをコピーすると、デフォルトではリンク元のファイル内容がコピーされる

`-d`オプションでシンボリックリンク自体がコピーされる

