# サブネットマスク

IPアドレスのネットワーク部とホスト部を区別するための数値。

- ネットワーク部 : ホスト(コンピューター)が所属するネットワーク
- ホスト部 : ホスト(コンピューター)のアドレス

=> サブネットマスクはネットワーク部を`1`、ホスト部を`0`で表す。

よく見る10進数の`255.255.255.0`は2進数では`11111111 11111111 11111111 00000000`

この場合、前半の24ビットがネットワーク部で後半の8ビットがホスト部。

ホスト部が8ビットの場合、2^8 = 256台が理論上、このネットワークに接続できるホストの数。

実際は、ネットワークアドレスとブロードキャストアドレスの2つを除いた254台が接続可能。

- ネットワーク部の桁数が少ない程、ホスト部の桁数が多くなるので多くのホストを接続することができる :dog:

## アドレスプレフィックス表記法

いわゆるCIDRのこと。

IPアドレスの末尾に`/`とネットワーク部の桁数を表記するやつ。

`192.168.1.10/24` => ネットワーク部が24ビットでホスト部が8ビット

## ネットワークアドレスとブロードキャストアドレス

ホスト部のIPアドレスの中には2つ特殊な働きをするので、コンピューターに割り当てることができないアドレスがある。

- ネットワークアドレス : ホスト部が全部`0` => LANを識別する番号として使用
- ブロードキャストアドレス : ホスト部が全部`1` => 同一ネットワーク内ホストへの一斉送信に使用

### 255.255.255.240

2進数にすると`11111111 11111111 11111111 11110000`

=> 前半28ビットがネットワーク部、後半4ビットがホスト部

=> ホスト部の数は2^4 = 16個(そのうちホストに割り当てることのできるIPの数は14個)

`0000 ～ 1111` : `0 ～ 15` ってするとちょっと危険 :dog:

IPアドレスが`10.170.70.19`の場合、2進数にすると第4オクテットの19は`00010011`

なのでホストアドレスは`00010000(16)`でブロードキャストアドレスは`00011111(31)`となる。

つまり、このIPアドレスは`10.170.70.16 ～ 10.170.70.31`がホスト部 => 第4が`0 ～ 15`じゃない！ :dog:

同様に192.168.1.xxのIPアドレスにおける255.255.255.240を考えてみる。

- 192.168.1.14 : 14 = 0000 1110 => 0000 0000 ～ 0000 1111 => 0 ～ 15
- 192.168.1.17 : 17 = 0001 0001 => 0001 0000 ～ 0001 1111 => 16 ～ 31
- 192.168.1.29 : 29 = 0001 1101 => 0001 0000 ～ 0001 1111 => 16 ～ 31
- 192.168.1.33 : 33 = 0010 0001 => 0010 0000 ～ 0010 1111 => 32 ～ 47

面白い :dog:

---

# 同じサブネットワークに属しているか(AND)

あるIPアドレス同士が同じサブネットワークに属しているかは、IPアドレスとサブネットマスクを`AND演算`した結果が同じであるかどうかで判断する。

```
# 10.1.2.146/255.255.255.240
00001010 00000001 00000010 10010010 (IP: 10.1.2.146)
11111111 11111111 11111111 11110000 (SM: 255.255.255.240)
-----------------------------------
00001010 00000001 00000010 10010010 (AND演算)

=> 最下位8ビットは 10010010

# 10.1.2.144/28
10010000 (144)
11110000 (/28=240)
--------
10010000 (AND)

=> 同じなので同じネットワーク

# 10.1.2.132/28
10000100 (132)
11110000 (240)
--------
10000100 (AND)

=> 違うので同じネットワークでない
```

