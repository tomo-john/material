# システムクロックとハードウェアクロック

- システムクロック : Linuxカーネル内に存在する時計
- ハードウェアクロック : コンピューターにハードウェアとして内臓された時計

システムクロックは起動時にハードウェアクロックを参照し設定される。

その後は別々に動き続け、起動してから時間が経つにつれ、ハードウェアクロックとシステムクロックの差が生じてくる。

---

# date

`date`コマンドは`システムクロック`を参照して現在の日時を表示するコマンド。

rootユーザーはdateコマンドを使用してシステムクロックを変更することが可能。

```
date [MMDDhhmmCCYY.ss]
```

- MM : 月
- DD : 日
- hh : 時
- mm : 分
- CC : 西暦の上2桁
- YY : 西暦の下2桁
- ss : 秒

## dateコマンドの書式

dateコマンドは引数を`+`で始めると指定した書式で表示する。

| 書式 | 説明       |
|------|------------|
| %Y   | 年         |
| %m   | 月(01〜12) |
| %d   | 日(01〜31) |
| %H   | 時(00〜23) |
| %M   | 分(00〜59) |
| %a   | 曜日       |
| %b   | 月名       |

```
date "+%Y/%m/%d(%a)" # => 2025/05/11(日)
```

```
touch $(date "+%Y%m%d").md
```

---

# hwclock

ハードウェアクロックの参照や設定を行うコマンド。

| オプション    | 説明                                               |
|---------------|----------------------------------------------------|
| -r(--show)    | ハードウェアクロックを表示                         |
| -w(--systohc) | システムクロックの時刻をハードウェアクロックに設定 |
| -s(--hctosys) | ハードウェアクロックの時刻をシステムクロックに設定 |

- システムクロックを表示 : `date`
- ハードウェアクロックを表示 : `hwclock -r`

- システムクロックを設定 : `date MMDDhhmmCCYY.ss`
- ハードウェアクロックを設定 : システムクロックをハードウェアクロックにする

- システムクロック => ハードウェアクロック : `hwclock -w(--systohc)`
- ハードウェアクロック => システムクロック : `hwclock -s(--hctosys)`

---

# timedatectl

systemdを採用したシステムでは`timedatectl`コマンドで日付と時刻、タイムゾーンの管理が可能。

```
timedatectl [サブコマンド]
```

| サブコマンド              | 説明                         |
|---------------------------|------------------------------|
| status                    | 現在の情報を表示(デフォルト) |
| set-time 時刻             | 時刻を設定(HH:MM:SS)         |
| set-time 日付             | 日付を設定(YYYY-MM-DD)       |
| set-time 日付 時刻        | 日付と時刻を設定             |
| set-timezone タイムゾーン | タイムゾーンを設定           |
| list-timezones            | タイムゾーンを一覧表示       |
| set-ntp yes or no         | NTPを使うかどうか            |

=> timedatectlコマンドではシステムクロックとハードウェアクロックを同時に設定する

=> 設定の変更はNTPサービスが有効になっているとエラーになる

