# cloud-init

`cloud-init`は、クラウド環境で仮想マシン(VM)やコンテナを初回起動時に自動設定するためのツール。

- クラウド環境(AWS, Azure, GCP, OpenStackなど)でよく使われる
- 仮想マシンの初回起動時に設定を自動化
- SSHキー、ホスト名、ユーザー作成、パッケージインストールなどを実行

# find

```
find 検索ディレクトリ 検索条件 -exec コマンド {} \;
```

`-exec`オプションではfindで見つけたファイルに対して、指定したコマンドを実行するオプション。

- `{}` → findが見つけたファイルのパスがここに入る(コマンドの引数)
- `\;` → `-exec`の終了を示す(`;`は特殊文字なので`\`をつけてエスケープ)

### 使用例

```
# findで見つけたファイルを削除
find . -name "*.log" -exec rm {} \;
```

=> カレントディレクトリ以下の`.log`ファイルを削除

# kill

| コマンド | 動作                         | 指定方法             | メリット                     | デメリット                               |
|----------|------------------------------|----------------------|------------------------------|------------------------------------------|
| kill     | プロセスID(PID)を指定        | kill <PID>           | ピンポイントで指定可能       | PIDを調べる必要がある                    |
| pkill    | プロセス名で検索             | pkill <プロセス名>   | 部分一致が使える             | 意図しないプロセスも終了する可能性がある |
| killall  | 完全一致するプロセス名を指定 | killall <プロセス名> | 同じ名前のプロセスを一括操作 | プロセス名が完全一致しなとダメ           |

```
# PID: 1234のプロセスを強制終了(SIGKILL)
kill -9 1234
```

```
# プロセス名を調べる(例)
ps aux | grep postgres
```

```
# postに部分一致するプロセス(postgresなど)を強制終了
pkill -9 post
```

```
# postgresに完全一致する名前のプロセスを強制終了
killall -9 postgres
```

- killはPID指定
- pkillは部分一致
- killallは完全一致

# uptime

システムが最後に再起動してからの経過時間(稼働時間)を表示するコマンド。

システムの安定性や、再起動の履歴を確認するときに便利。

CPUの負荷平均値も表示される。

```
# uptimeコマンドの実行結果例
09:54:39 up  2:00,  4 users,  load average: 0.19, 0.08, 0.02
```

左から順に、コマンド実行時刻、システム稼働時間(up)、ログインしているユーザー数(user)、CPUの負荷平均値(load average)。

load averageは最後の1分、5分、15分の順で、負荷100%を1とする。

`top`コマンドはプロセスの稼働状況を一定時間ごと(デフォルトは5秒)に更新して表示するコマンド。

=> 1行目はuptimeコマンドの実行結果とほぼ同じ

# スワップ領域

スワップ領域は物理メモリ(実メモリ、RAM)に収まらなかった情報を一時的に格納する為の、通常ハードディスク上に作成する領域、

ハードディスク上にある為、物理メモリよりも動作は各段に遅くなる。

Red Hat Enterprise Linux 8でのスワップ領域の推奨値(例):

- RAMが2GB以下 → `RAMの2倍`
- RAMが2GB～8GB → `RAMと同量`
- RAMが8GB～64GB → `4GBからRAMの0.5倍`
- RAMが64GB以上 → `最低4GB(負荷に依存)`

