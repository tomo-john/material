# mkfs

Linuxでファイルシステムを作成するためのコマンド(Make File System)。

指定したデバイスに対してファイルシステムを構築する。

```
mkfs -t <ファイルシステムの種類> <デバイス>
```

```
mkfs -t ext4 /dev/sda1
```

## 主なオプション

- `-t`: 作成するファイルシステムの種類を指定(`ext4`, `xfs`, `vfat`など)
- `-c`: 不良ブロックのチェック
- `-n`: 実際にはフォーマットせず、作成手順のみ表示(ドライラン)
- `-L`: ファイルシステムのラベルを付ける

## サポートされるファイルシステムの種類

- `ext2`, `ext3`, `ext4`: 一般的なLinuxファイルシステム(現在は`ext4`が標準的)
- `xfs`: 大容量のファイルやデータベースでの使用に適したファイルシステム
- `vfat`: Windowsと互換性があるファイルシステム
- `btrfs`: 次世代のファイルシステムでスナップショットや圧縮が可能

## 注意点

`mkfs`コマンドはデバイス全体を初期化し、データがすべて削除されるので実行には注意が必要。

## その他

ファイルシステムの種類によっては専用のコマンド(プログラム)がある。

=> `mkfs`は各ファイルシステムの種類に対応したプログラムのフロントエンド

```
# 以下はどちらも同じ

# 一般的な mkfs コマンド
sudo mkfs -t ext4 /dev/sda1

# ext4専用の mkfs.ext4 コマンド(プログラム)
sudo mkfs.ext4 /dev/sda1
```
---

# mke2fs

ext2, ext3, ext4ファイルシステム専用のコマンド。

=> ext2, ext3, ext4ファイルシステムの作成が可能(デフォルトは`ext2`)

```
sudo mke2fs -t ext4 /dev/sdb2
```

## オプション

- `-t`: ファイルシステムの種類指定
- `-j`: `ext3`ファイルシステムを作成する
- `-c`: 実行前に不良ブロックの走査
- `-m`: 予約領域(rootユーザー用)の割合を指定 => デフォルトは5%

---

# mkswap

スワップ領域を作成するコマンド。

指定したパーティションやファイルをスワップ領域として初期化。

システムがスワップとして使用できるようにする。

```
sudo mkswap /dev/sdb2
```

## スワップ領域とは？

物理メモリ(RAM)が不足したときにデータを一時的に退避させるためのディスク領域。

- メモリ不足の対策

  システム上の実行アプリケーションが多く、物理メモリが不足した場合、スワップ領域に一部データを退避させることでメモリを確保する。

- 一時的なメモリの拡張

  低スペック環境でメモリに余裕がない環境などで、スワップ領域をメモリの一部として使用。

  => 安定性を向上させる

- アプリケーションの休眠

  アプリケーションがメモリを必要としないとき、そのデータをスワップに退避し他のプロセスがメモリを使えるようにする。

スワップ領域はディスク上にあるため、アクセス速度はメモリよりも遅い。

スワップの使用量が多いとシステム全体が遅くなるためあくまでメモリの補助的な役割。

## オプション

- `-f`: 強制実行(警告出ない)
- `-L`: ラベル設定
- `-U`: UUIDの指定(通常はシステムが自動的にUUIDを生成する)

## スワップ領域の有効化

`mkswap`で作成したスワップ領域を実際に使用するには、`swapon`コマンドで有効化する必要がある。

```
sudo swapon /dev/sdb2
```

## /etc/fstabへの追加

再起動後もスワップ領域を有効化するには、`/etc/fstab`にスワップ領域を追加する。

```
# /etc/fstab に以下のようなエントリを追加
/dev/sdb2 none swap sw 0 0
```

=> (左から) デバイス名 マウントポイント ファイルシステムの種類 オプション ダンプ チェック順序 

`/etc/fstab`はファイルシステムの自動マウント設定を行うためのファイル。

システム起動時に指定したデバイスやファイルシステムが自動的にマウントされるように各パーティションやスワップ領域の情報を記載する。

