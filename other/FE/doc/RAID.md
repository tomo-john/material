# RAID

Redundant Arrays of Independent Disks : レイド

- redundant: 冗長な
- arrays: 配列
- independent: 独立した
- disks: ディスク

複数台の安価な磁気ディスクを組み合わせて、1つの仮想的なディスクとして扱うことで信頼性や性能を向上させる技術。

RAIDには0～5(6)のレベルがあり、その区分は本来のデータとエラー訂正用のデータをどうのように書込むかによって定義される。

## RAIDのレベル

- 0: 複数のディスクにデータを分散して書込むストライピング
- 1: 2台の磁気ディスクに同じ内容を書込むミラーリング
- 2: ストライピング+エラー訂正用のハミング記号を書き込み(最少でも5台構成)
- 3: ストライピング+エラー訂正用のパリティビットを1台のディスクに書き込み
- 4: RADI3のパリティビットの書き込みをブロック単位で行う
- 5: パリティビットもデータと同様に分散して書込む
- 6: 最低4台のHDD・パリティを2重に生成・分散して記録

## パリティビット(parity)

複数のデータから誤り検出や復元に使えるチェック用のビット(情報)を作る仕組み。

RAID5・6では、パリティディスクを固定せずに分散させて記録するのが一般的。

=> 特定の1台に負荷集中しないようにするため

- RADI5: 1台分のパリティ => 最低3台必要、1台壊れても復元可能
- RAID6: 2台分のパリティ => 最低4台必要、2台壊れても復元可能

### パリティの基本イメージ(XOR)

RAIDのパリティでは`XOR(排他的論理和)`演算で作るのが基本。

XOR:

| A | B | X |
|---|---|---|
| 0 | 0 | 0 |
| 0 | 1 | 1 |
| 1 | 0 | 1 |
| 1 | 1 | 1 |

例として、3台のディスクにデータを分散して保存するとき:

| ディスクA | ディスクB | パリティ(XOR) |
|-----------|-----------|---------------|
| 1         | 0         | 1             |
| 0         | 1         | 1             |
| 1         | 1         | 0             |

仮にディスクBが壊れたとき:

`ディスクB = ディスクA XOR パリティ`で求めることができる。

=> パリティは、他のすべてのデータをXORした結果のため、逆算して壊れた1つのデータを求めるられる

