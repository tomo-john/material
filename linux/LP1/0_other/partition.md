# パーティション

## ハードディスクのレイアウト設定とパーティション構成

1. MBR(Master Boot Recort)とGPT(GUID Partition Table)
- MBR: 従来のパーティション方式、最大4つのプライマリパーティションをサポート、上限2TB
- GPT: より新しい方式、最大128個のパーティション、サイズ上限はなし

2. パーティションの種類
- プライマリパーティション: 基本的なパーティション(MBRでは4つまで)
- 拡張パーティション: MBRの制約により4つ以上プライマリパーティションを作成する際に使用
- 論理パーティション: 拡張パーティション内に作成され、システム用やデータ用の追加パーティション

3. パーティションテーブル管理ツール
- `fdisk`: MBRパーティションを管理するためのコマンドラインツール

  => ディスクの確認やパーティションの作成・削除が可能

- `gdisk`: GPTパーティションを管理するためのコマンドラインツール
- `parted`: MBR, GPTの両方をサポートするパーティション管理ツール

4. 基本的なパーティションの設計
- `/(ルート)`: OSの基本ファイルを格納(通常10GB～20GB程度割り当てる)
- `swap領域`: メモリ不足を補うための仮想メモリ領域(物理メモリの1～2倍程度)
- `/home`: ユーザーのホームディレクトリを格納(個人データや設定ファイルが保存されるので大きめに)
- `/boot`: カーネルやGRUB関連の設定ファイルを格納(通常500MB～1GB程)

## ハードディスクのフォーマットとファイルシステム

1. ファイルシステムの種類
- `ext4`: Linux標準ファイルシステム、安定性やパフォーマンス高く広く利用されている
- `xfs`: 高いスループットが求められる場合に適したファイルシステム(大容量データにも)
- `btrfs`: スナップショットや圧縮をサポートする次世代ファイルシステム(発展途上)

2. ファイルシステム作成
- `mkfs`コマンドでパーティションにファイルシステムを作成
  ```
  # どちらも同じ
  sudo mkfs -t ext4 /dev/sda1
  sudo mkfs.ext4 /dev/sda1
  ```

## パーティションとファイルシステムのマウント

1. マウントとマウントポイント
- Linuxではファイルシステムをディレクトリ(マウントポイント)にマウントする必要あり
- マウントポイントは任意のディレクトリを指定できる
- `/mnt`や`/media`は一時的なマウントに利用される

```
sudo mount /dev/sda1 /mnt
```

2. /etc/fstabファイル
- `fstab`はシステム起動時に自動的にマウントする設定を定義したファイル

  => ディスクのUUID(ユニークID)を指定することで安定したマウントが可能

`/ect/fstabの例`

```
UUID=xxxx-xxxx-xxxx / ext4 defaults 0 1
UUID=yyyy-yyyy-yyyy /home ext4 defaults 0 2
```
5番目の項目(0)はdumpコマンドによるバックアップの対象かどうかを指定

=> 通常0が指定され、バックアップされない

6番目の項目(1や2)はファイルシステムのチェックの順序

3. 自動マウントとアンマウント
- `mount -a`: `fstab`に基づいてすべての未マウントファイルシステムをマウント
- `umount`: マウントを解除(アンマウント)

