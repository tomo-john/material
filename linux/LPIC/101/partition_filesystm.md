# パーティション・ファイルシステム

物理ディスクが使用できるまでの流れ(基本ステップ): 

- 1: パーティション作成
- 2: ファイルシステム作成
- 3: マウント

---

# 関連コマンド概要

## パーティション関連

| コマンド | 説明                                             |
|----------|--------------------------------------------------|
| fdisk    | パーティションの作成・削除・変更・確認 `MBR`     |
| gdisk    | パーティションの作成・削除・変更・確認 `GPT`     |
| parted   | MBRにもGPTにも対応したパーティション管理コマンド |

## ファイルシステム・作成

| コマンド | 説明                                                                 |
|----------|----------------------------------------------------------------------|
| mkfs     | ファイルシステムを作成(各ファイルシステムプログラムのフロントエンド) |
| mke2fs   | ext2, ext3, ext4ファイルシステムを作成                               |
| mkswap   | スワップ領域を作成                                                   |

## 利用状況確認

| コマンド | 説明                                                 |
|----------|------------------------------------------------------|
| df       | ファイルシステムの空き容量を確認                     |
| du       | ファイルシステムやディレクトリが占めている容量を確認 |

## ファイルシステム・チェック・修復・管理

| コマンド | 説明                                                                           |
|----------|--------------------------------------------------------------------------------|
| fsck     | ファイルシステムのチェック・修復(各ファイルシステムプログラムのフロントエンド) |
| e2fsck   | ext2, ext3, ext4ファイルシステムのチェック・修復                               |
| tune2fs  | ext2, ext3, ext4ファイルシステムのさまざまなパラメータを設定                   |

## XFSコマンド

| コマンド   | 説明                                |
|------------|-------------------------------------|
| mkfs.xfs   | XFSファイルシステムを作成           |
| xfs_info   | XFSファイルシステムの情報を表示     |
| xfs_db     | XFSファイルシステムのデバッグ       |
| xfs_check  | XFSファイルシステムをチェック       |
| xfs_admin  | XFSファイルシステムのパラメータ変更 |
| xfs_fsr    | XFSファイルシステムのデフラグ       |
| xfs_repair | XFSファイルシステムを修復           |

---

# 各コマンド詳細

## parted

ディスクのパーティションを作成・変更・削除するためのコマンド。

`fdisk`の後続的な立ち位置でGPTパーティションにも対応している。

```
# 基本構文
parted [デバイス名]

# 例
parted /dev/sda
```

これで対話モードに入る。(parted)ってプロンプトが出るやつ。

以下のように非対話モードなら1発でコマンド実行もできる。

```
# 非対話モード
parted /dev/sda mkpart primary ext4 1MiB 2GiB
```

### サブコマンド

| サブコマンド | 説明                                                         |
|--------------|--------------------------------------------------------------|
| mklabel      | パーティションテーブルを作る(MBR: `msdos`, GPT: `gpt`)       |
| mkpart       | パーティションを作成(ファイルシステム種類 開始位置 終了位置) |
| print, p     | パーティションテーブルを表示                                 |
| quit, q      | 対話モード終了                                               |

```
# 2GiBのパーティションを1つ作成する
parted /dev/sda
(parted) mklabel gpt
(parted) mkpart primary ext4 1MiB 2GiB
(parted) print
(parted) quie
```

- 1: パーティションテーブルの指定 => `mklabel`
- 2: パーティションの作成 => `mkpart`
- 3: 作成されたパーティション情報の確認 => `print`

### mklabel

```
(parted) mklabel [パーティションテーブル]
```

未指定の場合は`MBR形式`。

=> 明示的にMBRを指定する場合は`mklabel msdos`、GPTの場合は`mklabel gpt`

### mkpart

```
(parted) mkpart [パーティションタイプ ファイルシステム種別 パーティション名] 開始位置 終了位置
```

=> パーティションタイプはMBR形式で指定可能で、primary(基本)、extended(拡張)、logical(論理)を指定

---

