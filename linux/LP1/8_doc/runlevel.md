# ランレベル

Linux起動時の動作モード。

## 数値 / ターゲット / 起動モード

| ランレベル | Systemdのターゲット | 動作                                         |
|------------|---------------------|----------------------------------------------|
| 0          | poweroff.target     | システムのシャットダウン                     |
| 1/s/S      | rescue.target       | rootだけが利用可能なシングルユーザーモード   |
| 2          | multi-user.target   | マルチユーザーモード(ネットワークなし)       |
| 3          | multi-user.target   | マルチユーザーモード(ネットワークあり)       |
| 4          | multi-user.target   | 未使用(カスタマイズ用)                       |
| 5          | graphical.target    | マルチユーザーモード(デスクトップ環境が有効) |
| 6          | reboot.target       | システム再起動                               |

---

# SysVinit

## 設定ファイル

SysVinitではシステムのデフォルトのランレベルや挙動を`/etc/inittab`で設定する。

```
# /etc/inittabの例(デフォルトのランレベルを3に設定)
id:3:initdefault
```

## ランレベルと起動スクリプト

SysVinitではランレベルごとに異なる起動スクリプトを実行する。

起動スクリプトの配置場所は`/etc/rc.d/rc?.d/`(?にはランレベル番号の0～6)。

スクリプト名称の先頭に`S(Start)`または`K(Kill)`が付く。

=> Sは起動するスクリプトでKは起動されないスクリプト

さらにSまたはKの後には数字2桁がつき、これが実行されるスクリプトの優先順位になる(数字の小さいスクリプトから順に実行)。

=> ランレベル3でネットワークを起動するスクリプトであれば、`/etc/rc3.d/S01network`など(S01などで最初に実行されるスクリプト)


## runlevelコマンド(ランレベルの確認)

現在のランレベルと直前のランレベルを表示するコマンド。

```
# runlevelを実行
N 3
```

- N: 直前のランレベル(Nはなしを意味する)
- 3: 現在のランレベル

現在(直前)のランレベルを確認するコマンドなので、ランレベルの変更はできない。

## init / telinit(ランレベルの変更)

それぞれランレベルを変更するコマンド(telinitは基本的にinitと同じ役割)。

ランレベルの変更は一時的なもので、再起動するとデフォルトのランレベルでまた起動される。

コマンドの引数には変更したいランレベルを指定する(root権限が必要)。

```
# シャットダウン
init 0

# 再起動
init 6
```

