# シェルスクリプト(Bash)

## シェルの基本概念
- シェルとは: ユーザーとOSの間のインターフェース

  コマンドを入力して実行したり、スクリプトを実行したりするための環境を提供

- 代表的なシェル: Linuxではbashが最も一般的

  sh(Bourne Shell), ksh(Korn Shell), zsh(Z Shell)などがある

## 環境変数
- 環境変数とは: システム全体やシェルの動作に影響を与える変数
- 環境変数の確認: `echo`コマンドと`$`で環境変数の値を表示可能

  → `echo $PATH`: `PATH`環境変数の内容を表示

## シェルのカスタマイズ
- プロンプトの変更: シェルプロンプトの表示形式をカスタマイズすることが可能

  → `PS1`環境変数を変更することで、プロンプトの表示内容を変更できる

- 設定ファイル: `~/.bashrc`, `~/.bash_profile`などの設定ファイルを編集することで

  自動で実行されるコマンドやコマンド設定を指定できる

## 基本的なスクリプトの実行
- スクリプトの実行: シェルスクリプトを実行するには、スクリプトファイルに実行権の付与が必要

  ```
  chmod +x script.sh
  ```

## 変数
シェルスクリプトでは変数を使って値を一時的に保存したり、操作に利用することが可能
- 変数の宣言: 変数名の後に`=`で値を指定(`=`の前後にスペースは入れない!)

  ```
  my_var="john"
  ```

- 変数の参照: 変数名の前に`$`をつけることで変数の値を参照できる

  ```
  echo $my_var # 出力: john
  ```

- 数値計算: 変数に数値を代入して計算も可能(数値計算は`$((...))`で囲むことで行う)

  ```
  num1=2
  num2=8
  sum=$((num1 + num2))
  echo $sum # 出力: 10
  ```

## 環境変数の設定
環境変数を設定してシェルやシステムに反映させるには`export`コマンドを使用
```
export MY_ENV_VAR="sample john"
echo $MY_ENV_VAR # 出力: sample john
```

`~/.bashrc`や`~/.bashprofile`に環境変数を記述することで、次回シェル起動時にも同じ環境変数を利用できる
```
echo 'export DOG_NAME="john"' >> ~/.bashrc
source ~/.bashrc # 即座に反映
```

## 条件分岐
シェルスクリプトでは`if`や`case`を使用するのが一般的

`if文`
```
if [条件式]; then
  # 真の時の実行文
elif [別の条件式]; then
  # 別の条件が真の時の実行文
else
  # すべての条件が偽の時の実行文
fi
```

`例`
```
# numが10以上かどうか
num=28

if [$num -ge 10]; then
  echo "10以上です"
else
  echo "10未満です"
fi
```

`主な条件式1(整数)`
- `-eq`: 等しい
- `-ne`: 等しくない
- `-lt`: より小さい
- `-le`: 以下
- `-gt`: より大きい
- `-ge`: 以上
- `-z`: 文字列が空
- `-n`: 文字列が空でない

`主な条件式2(文字列)`
- `=`: 等しい
- `!=`: 等しくない
- `<`: 文字列が辞書順で小さい `[[...]]内のみ使用可能`
- `>`: 文字列が辞書順で大きい `[[...]]内のみ使用可能`

`case文`
```
case 変数 in
  値1)
    # 値1に一致する時の式
    ;;
  値2)
    # 値2に一致する時の式
  *)
    # どれにも一致しない場合の式
    ;;
esac
```

`例`
```
# $animalの値に応じて分岐
animal="dog"

case $animal in
  "bear")
    echo "くま"
    ;;
  "dog")
    echo "いぬ"
    ;;
  *)
    echo "未知の生物"
    ;;
esac
```

## ループ構造
Bashでは`for`, `while`, `until`の3つのループが基本的な構文

`for`: 指定したリストや範囲に対して繰り返し処理を行う
```
for 変数名 in リスト; do
  # 各要素に対して実行する処理
done
```
```
for i in 1 2 3 4 5; do
  echo "number is $i"
done
```
数値範囲を指定する場合は`{開始..終了}`
```
for i in {1..5}; do
  echo "number is $i"
done
```

`while`: 指定した条件が真の間、処理を繰り返す
```
while [ 条件式 ]; do
  # 条件が真の間、実行する処理
done
```
```
i=1
while [ $i -le 5 ]; do
  echo "number is $i"
  i=$(($i + 1))
done
```

`until`: `while`と逆に指定した条件が偽の間、処理を繰り返す
```
until [ 条件式 ]; do
  # 条件が偽の間、実行する処理
done
```
```
i=1
until [ $i -gt 5 ]; do
  echo "number is $i"
  i=$((i + 1))
done
```

ループの制御コマンドには`break`, `continue`がある
- `break`: ループを中断して抜ける
- `continue`: 現在の反復をスキップし、次の反復へ進む

```
for i in {1..5}; do
  if [ $i -eq 3 ]; then
    break
  fi
  echo "john $i"
done
```

