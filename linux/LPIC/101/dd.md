# dd

ファイルやデバイスのデータをブロック単位でコピーするためのコマンド。

ディスクイメージの作成やバックアップ、ゼロ埋めなどに使用される。

## 基本構文

```
dd if=<入力ファイル> of=<出力ファイル> bs=<ブロックサイズ> count=<ブロック数> [オプション]
```

- if=<入力ファイル>: 読み取る元のファイル(例: ディスクデバイス、/dev/urandom、/dev/zeroなど)
- of=<出力ファイル>: 書込む先のファイル
- bs=<ブロックサイズ>: 1回のコピーで処理するデータサイズ(例: 1K, 512, 4Mなど)
- count=<ブロック数>: 指定した`bs`のサイズのブロックをいくつコピーするか
- status=progress: 進捗を表示

## 使用例: ランダムデータを含むファイルを作成(4KBの例)

```
# 4KBサイズのファイルを作成
dd if=/dev/urandom of=test_4kb bs=1K count=4
```

- if=/dev/urandom: ランダムデータを入力として使用
- of=test_4kb: 出力ファイル名を指定(今回はtest_4kbに指定)
- bs=1K: ブロックサイズを1KBに設定
- count=4: 書き込み回数を4回に指定 => 1KB x 4ブロック = 4KBのファイルを作成

`if=/dev/zero`とするとすべて0のデータを読み込み0埋めの空ファイルの作成ができる

=> 空のディスク領域の確保やデバイスのクリアに使用できる

## 使用例: USBメモリやディスクを丸ごとバックアップ

```
dd if=/dev/sda of=usb.backup.img bs=4M status=progress
```

countを指定しなかった場合、`if=`の終わり(EOF)まで全コピーする。

この場合`/dev/sda`がUSBメモリがマウントされている前提。=> 本来はlsblkコマンドなどで確認する

USBが16GBなら16GB、32GBなら32GBまるごとコピーされる。

通常、USBやHDDのバックアップでは`count`を指定しないことが多い。

## 使用例: バックアップしたディスクイメージを書き出す

```
dd if=usb.backup.img of=/dev/sda bs=4M status=progress
```

`of=/dev/sda`の箇所は間違えるとディスクが上書きされるので要注意。


## 使用例: HDDやSDDの完全消去(データ復旧できないようにする)

```
dd if=/dev/urandom of=/dev/sda bs=1M status=progress
```

`/dev/sda`がシステムのディスクの場合の例。

`/dev/urandom`を使用することでランダムなデータで埋め尽くす。(復旧困難)

