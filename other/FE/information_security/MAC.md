# メッセージ認証符号

メッセージ認証符号(Message Authentication Code : MAC)は、通信内容の改ざんの有無を検証し、完全性を保証するために通信データから生成される固定長のビット列のこと。

生成には共通鍵暗号方式やハッシュ関数が用いられる。

送信者はメッセージからMACを生成し、メッセージとともに送信する。

受信者は受け取ったメッセージから、送信者と同様の方法でMACを生成し、受け取ったMACと自分が生成したMACを比較。

メッセージ、鍵、アルゴリズムが同じであれば、生成されるMACは同じになるので、両者が一致すればメッセージが破壊したり改ざんされていないと判断できる。

---

# メッセージ認証

共通鍵を用いて、メッセージの内容が改ざんされていないことを確認する仕組み。

### 事前準備

送信者と受信者で共通鍵を秘密裏に共有しておく

### 送信者側の処理

- 1. メッセージと共通鍵を基に、ハッシュ関数を用いて`メッセージ認証コード(MAC: Message Authenticaton Code)`を生成
- 2. メッセージとMACを受信者へ送信

### 受信者側の処理

- 3. 受信したメッセージと共通鍵を基に、同じハッシュ関数を用いてMACを生成
- 4. 「2」,「3」のMACが一致するかを検証

ここで、MAC値が一致すれば、受信者は改ざんされていないことを確認できると同時に、なりすまし対策にもなる。

受信者も送付されたメッセージから共通鍵を使って同じMACが生成できるので、否認防止はできない。

- 否認防止: 送信者が自分は送っていないと後から否認できないようにする仕組みのこと

| 項目           | デジタル署名   | メッセージ認証 |
|----------------|----------------|----------------|
| 改ざん対策     | OK             | OK             |
| なりすまし対策 | OK             | OK             |
| 否認防止       | OK             | No..           |
| 鍵             | 公開鍵・秘密鍵 | 秘密鍵・秘密鍵 |
| 付加情報       | デジタル署名   | MAC            |

