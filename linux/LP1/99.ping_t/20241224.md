# systemdのランレベル/ブートターゲット

システム起動時に最初に読込まれるUnitは`/etc/systemd/system/default.target`。

`default.target`をSysVinitでのランレベルに相当するUnitへのシンボリックリンクを作成することで、期待するサービル群を起動できるようになる。

| ランレベル | ターゲット        |
|------------|-------------------|
| 0          | poweroff.target   |
| 1          | rescue.target     |
| 2,3,4      | multi-user.target |
| 5          | graphical.target  |
| 6          | reboot.target     |

これらのターゲットは`/lib/systemd/system`配下に格納されている。

SysVinitとの関連がわかりやすいように、runlevel0.target～runlevel6.targetまでのシンボリックリンクも用意されている。

```
# systemdが稼働するシステムにおいて、次回起動時のランレベルの確認
cd /etc/systemd/system
ls -l default.target
```

# ハードディスクのレイアウト設計

論理ボリュームを作成する際の主な手順は以下のとおり。

- 物理ボリューム(PV)の作成: pvcreateコマンド
- ボリュームグループの作成: vgcreateコマンド
- 論理ボリューム(LV)の作成: lvcreateコマンド

pvcreate → vgcreate → lvcreate

```
# /dev/sdc1と/dev/sdd1を物理ボリューム(PV)として初期化
pvcreate /dev/sdc1 /dev/sdd1

# /dev/sdc1と/dev/sdd1から新しいボリュームグループ(VG1)を新規に作成
vgcreate vg1 /dev/sdc1 /dev/sdd1 

# vg1から容量100MB(-L 100MB)で名前がlv1(-n lv1)という論理ボリューム(LV)を作成
lvcreate -L 100MB -n lv1 vg1
```

作成した論理ボリュームを実際に使用するには`mkfs`コマンドで論理ボリュームにファイルシステムを作成し、`mount`コマンドでマウントする。

# xfs_check

XFSはシリコングラフィックス社(SGI)が開発したジャーナリングファイルシステム。

| コマンド   | 説明                                                         |
|------------|--------------------------------------------------------------|
| mkfs.xfs   | XFSファイルシステムを作成(mkfs -t xfsで呼び出されるコマンド) |
| xfs.info   | ファイルシステムの情報を表示                                 |
| xfs.db     | ファイルシステムのデバッグ                                   |
| xfs.check  | ファイルシステムのチェック                                   |
| xfs.fsr    | ファイルシステムのデフラグ                                   |
| xfs.repair | ファイルシステムを検査・修復する                             |

# sort

- -t 区切り文字: 指定した文字を区切り文字としてフィールドを認識
- -n: 数字を文字ではなく数値としてソート
- -k フィールド: ソート対象とするフィールドを指定

```
# ,区切りのファイルの2番目のフィールドを基準に数値として昇順にソート
sort -k 2 -n -t , file
```

# 権限

| 権限 | ファイル             | ディレクトリ                                               |
|------|----------------------|------------------------------------------------------------|
| 読み | ファイルの内容を参照 | ディレクトリの内容を参照(ls, find)                         |
| 書き | ファイルに書き込み   | 新規ファイル作成、リネーム・削除(touch, mv, rm)            |
| 実行 | ファイルを実行       | ディレクトリ内のファイルにアクセス、ディレクトリに移動(cd) |

# touch

- -t 時刻: アクセス時刻と修正時刻を指定した時刻に変更
- -a: アクセス時刻を変更
- -m: 修正時刻を変更

`-t`オプションをつけなかった場合はタイプスタンプが現在時刻に修正される

```
# ファイルの修正時刻を現在の時刻に変更
touch -m file
```

# mkdir

- -m アクセス権: 指定したアクセス権でディレクトリを作成
- -p: 引数に階層のあるディレクトリを指定した場合、存在しない中間ディレクトリも同時に作成

```
# カレントディレクトリにdir1/dir2/dir3を作成(dir1は存在しない)
mkdir -p dir1/dir2/dir3

# 777権限でdirを作成
mkdir -m 777 dir
```

# rpm

- -q(--query) パッケージ名: 指定したパッケージがインストールされているかを照会
- -a(--all): インストール済みの全パッケージの表示

```
# システムにインストールされている全てのパッケージを表示
rpm -qa
rpm --query --all
```

