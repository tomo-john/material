# ファイルのエラー処理

## 1.feof
ファイルポジションがファイルの終わり(EOF)に達しているかどうかを調べるための関数

```c
nrtn = feof(fp);
```
- リターンはエラーになっているときは0以外の数値、エラーになっていなければ0が返される

```c
#include <stdio.h>

int main(){
  FILE *fp1;
  char szfname1[] = "ky202.c";
  char szdata[90];
  int ni;

  fp1 = fopen(szfname1, "r");
  if(fp1 == NULL){
    printf("ファイルオープン失敗\n");
    return 1;
  }

  ni = 0;
  while(1){
    fgets(szdata, 81, fp1);
    printf("%d: %s", ++ni, szdata);
    if(feof(fp1)){
      printf("\nEOF到達\n");
      break;
    }
  }

  fclose (fp1);
}
```

## 2.ferror
ファイル(ポインタ)がエラーになっているかどうかを調べるための関数

```c
nrtn = ferror(fp);
```
- リターンはEOFに達していれば0以外、達していなければ0が返される

```c
#include <stdio.h>

int main(){
  FILE *fp1;
  char szfname1[] = "ky203.dat";
  int nrtn;

  fp1 = fopen(szfname1, "r");
  if(fp1 == NULL){
    printf("ファイルオープン失敗\n");
    return 1;
  }

  nrtn = fputc('Z', fp1);
  if(ferror(fp1)){
    printf("エラー\n");
  } else {
    printf("正常\n");
  }

  fclose(fp1);
}
```

